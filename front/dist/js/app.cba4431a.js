(function(){"use strict";var e={3243:function(e,t,i){var o=i(9242),a=i(3396);const n={id:"app"};function s(e,t,i,o,s,l){const r=(0,a.up)("router-view");return(0,a.wg)(),(0,a.iD)("div",n,[(0,a.Wm)(r,null,{default:(0,a.w5)((({Component:t})=>[((0,a.wg)(),(0,a.j4)(a.Ob,null,[e.$route.meta.keepAlive?((0,a.wg)(),(0,a.j4)((0,a.LL)(t),{key:e.$route.name})):(0,a.kq)("",!0)],1024)),e.$route.meta.keepAlive?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)((0,a.LL)(t),{key:e.$route.name}))])),_:1})])}var l={name:"App",methods:{reload(){this.isRouterAlive=!1,this.$nextTick((function(){this.isRouterAlive=!0}))}}},r=i(89);const c=(0,r.Z)(l,[["render",s]]);var d=c,h=i(9992),u=i(6954),m=i(3295),g=(i(5110),i(678));const p=e=>((0,a.dD)("data-v-55d851dc"),e=e(),(0,a.Cn)(),e),w={id:"head-group"},v={class:"head-btn",style:{"padding-left":"10px"}},k={class:"head-btn",style:{"padding-right":"10px"}},f={key:0,id:"head-action-group"},_=p((()=>(0,a._)("div",{style:{"margin-top":"5px"}},"书架",-1))),y=p((()=>(0,a._)("div",{style:{"margin-top":"5px"}},"历史",-1))),b=p((()=>(0,a._)("div",{style:{"margin-top":"5px"}},"我的",-1)));function C(e,t,i,o,n,s){const l=(0,a.up)("van-icon"),r=(0,a.up)("van-search"),c=(0,a.up)("van-sticky"),d=(0,a.up)("van-overlay"),h=(0,a.up)("manga-home-page"),u=(0,a.up)("van-tab"),m=(0,a.up)("book-home-page"),g=(0,a.up)("van-tabs");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(c,{"z-index":"45"},{default:(0,a.w5)((()=>[(0,a._)("div",w,[(0,a._)("div",v,[(0,a.Wm)(l,{name:"gem-o",size:"25"})]),(0,a.Wm)(r,{placeholder:"搜索作品名",readonly:"",style:{height:"100%"},onClick:t[0]||(t[0]=e=>this.$router.push("/search"))}),(0,a._)("div",k,[(0,a.Wm)(l,{onClick:t[1]||(t[1]=e=>n.showMenu=!n.showMenu),name:"apps-o",size:"25"})])])])),_:1}),n.showMenu?((0,a.wg)(),(0,a.iD)("div",f,[(0,a._)("div",{class:"head-action-item",onClick:t[2]||(t[2]=e=>this.$router.push("/collection"))},[(0,a.Wm)(l,{name:"bar-chart-o",size:"20"}),_]),(0,a._)("div",{class:"head-action-item",onClick:t[3]||(t[3]=e=>this.$router.push("/history"))},[(0,a.Wm)(l,{name:"underway-o",size:"20"}),y]),(0,a._)("div",{class:"head-action-item",onClick:t[4]||(t[4]=e=>this.$router.push("/user"))},[(0,a.Wm)(l,{name:"user-o",size:"20"}),b])])):(0,a.kq)("",!0),(0,a.Wm)(d,{show:n.showMenu,onClick:t[5]||(t[5]=e=>n.showMenu=!1),style:{top:"50px"}},null,8,["show"]),(0,a.Wm)(g,{active:n.activePage,"onUpdate:active":t[6]||(t[6]=e=>n.activePage=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{title:"漫画"},{default:(0,a.w5)((()=>[(0,a.Wm)(h)])),_:1}),(0,a.Wm)(u,{title:"小说"},{default:(0,a.w5)((()=>[(0,a.Wm)(m)])),_:1})])),_:1},8,["active"])],64)}var I=i(6265),S=i.n(I);const x=S().create({baseURL:"http://10.91.11.58:8000/",timeout:6e4,withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}});x.interceptors.request.use((function(e){return e}),(function(e){return console.log(e),Promise.reject(e)})),x.interceptors.response.use((function(e){const t=e.data,i=t.code,o=t.msg,a=t.error_msg;return 0===i?console.log(o):console.log(a),t}),(function(e){return console.log(e),Promise.reject(e)}));var W=x;function P(e){const t=new FormData;return Object.keys(e).forEach((i=>{const o=e[i];Array.isArray(o)?o.forEach(((e,o)=>t.append(i+`[${o}]`,e))):t.append(i,e[i])})),t}function D(e){return W({url:"http://127.0.0.1:8000/manga/getMangaChapterImages/",method:"POST",data:P(e)})}var L=i(7139);const T={key:0},H={class:"list-title"},O={class:"grid"},z=["onClick"],M={class:"manga-title"},$={class:"manga-tag"},F={class:"btn-box"},V=(0,a.Uk)("查看更多"),B=(0,a.Uk)("换一换");function q(e,t,i,o,n,s){const l=(0,a.up)("van-image"),r=(0,a.up)("van-swipe-item"),c=(0,a.up)("van-swipe"),d=(0,a.up)("van-button");return n.loadingPage?((0,a.wg)(),(0,a.iD)("div",T,[(0,a.Wm)(c,{autoplay:3e3,"lazy-render":""},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.swipeImages,(e=>((0,a.wg)(),(0,a.j4)(r,{key:e},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{src:e},null,8,["src"])])),_:2},1024)))),128))])),_:1}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.mangaLists,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"manga-group",key:t},[(0,a._)("h3",H,(0,L.zw)(e.title),1),(0,a._)("div",O,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.data.slice(0,6),((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"grid-item",onClick:t=>s.mangaInfo(e),key:t},[(0,a.Wm)(l,{radius:"10",width:"100%",height:"42vw",fit:"cover",src:e.image_url},null,8,["src"]),(0,a._)("div",M,(0,L.zw)(e.title),1),(0,a._)("div",$,(0,L.zw)(e.category.name),1)],8,z)))),128))]),(0,a._)("div",F,[(0,a.Wm)(d,{plain:"",style:{"margin-right":"5px"},color:"#666666"},{default:(0,a.w5)((()=>[V])),_:1}),(0,a.Wm)(d,{color:"#666666",onClick:e=>s.change(t)},{default:(0,a.w5)((()=>[B])),_:2},1032,["onClick"])])])))),128))])):(0,a.kq)("",!0)}const E="/manga/";function N(){return W({url:E+"getHomeManga/",method:"POST"})}function U(e){return W({url:E+"getMangaInfo/",method:"POST",data:P(e)})}function j(e){return W({url:E+"getMangaChapterList/",method:"POST",data:P(e)})}function Y(e){return W({url:E+"getLastReadChapter/",method:"POST",data:P(e)})}function A(e){return W({url:E+"addMangaHistory/",method:"POST",data:P(e)})}function J(e){return W({url:E+"setMangaCollect/",method:"POST",data:P(e)})}function K(e){return W({url:E+"getMangaChapterImages/",method:"POST",data:P(e)})}function Z(e){return W({url:E+"getMangaHistory/",method:"POST",data:P(e)})}function Q(e){return W({url:E+"deleteMangaHistory/",method:"POST",data:P(e)})}function R(e){return W({url:E+"getMangaCollections/",method:"POST",data:P(e)})}function G(e){return W({url:E+"deleteMangaCollections/",method:"POST",data:P(e)})}function X(e){return W({url:E+"getMangaSearch/",method:"POST",data:P(e)})}var ee={name:"mangaHomePage",data(){return{loadingPage:!0,swipeImages:["https://f2.kkmh.com/image/220412/TVBN86Qc5.png-t.w1125.png.h","https://f2.kkmh.com/image/220412/TVBN86Qc5.png-t.w1125.png.h"],mangaLists:[]}},methods:{mangaInfo(e){localStorage.setItem("currentMangaInfo",JSON.stringify(e)),this.$router.push("/mangaInfo/"+e.id)},change(e){this.mangaLists[e].data.sort((()=>Math.random()-.5))},async init(){await N().then((e=>this.mangaLists=e.data)),m.F.clear()}},created(){m.F.loading({message:"加载中",duration:0}),this.init()},activated(){console.log("缓存界面")}};const te=(0,r.Z)(ee,[["render",q],["__scopeId","data-v-1596dcc6"]]);var ie=te;const oe={style:{width:"100%"}},ae={class:"list-title"},ne=["onClick"],se={class:"list-top-info"},le={class:"list-top-detail",style:{"margin-top":"5px"}},re={class:"list-item-group"},ce=["onClick"],de={style:{color:"lightskyblue"}},he=(0,a.Uk)(" / "),ue={style:{color:"#999999","font-size":"10px"}};function me(e,t,i,o,n,s){const l=(0,a.up)("van-image"),r=(0,a.up)("van-swipe-item"),c=(0,a.up)("van-swipe");return(0,a.wg)(),(0,a.iD)("div",oe,[(0,a.Wm)(c,{autoplay:3e3,"lazy-render":""},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.swipeImages,(e=>((0,a.wg)(),(0,a.j4)(r,{key:e},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{src:e},null,8,["src"])])),_:2},1024)))),128))])),_:1}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.homeBooks,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"list-group",key:t},[(0,a._)("div",ae,[(0,a._)("h3",null,(0,L.zw)(e.title),1)]),(0,a._)("div",{class:"list-top",onClick:t=>s.openBook(e.top_book.book_url)},[(0,a.Wm)(l,{class:"list-top-img",src:e.top_book.image_url},null,8,["src"]),(0,a._)("div",se,[(0,a._)("div",null,[(0,a._)("b",null,(0,L.zw)(e.top_book.name),1)]),(0,a._)("div",le,(0,L.zw)(e.top_book.detail),1)])],8,ne),(0,a._)("div",re,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.book_list,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"list-item van-ellipsis",key:t,onClick:t=>s.openBook(e.book_url)},[(0,a._)("span",de,(0,L.zw)(e.name),1),he,(0,a._)("span",ue,(0,L.zw)(e.author),1)],8,ce)))),128))])])))),128))])}const ge="/book/";function pe(){return W({url:ge+"getHomeBook/",method:"GET"})}function we(e){return W({url:ge+"getBookInfo/",method:"POST",data:P(e)})}function ve(e){return W({url:ge+"getBookChapter/",method:"POST",data:P(e)})}function ke(e){return W({url:ge+"getLastReadChapter/",method:"POST",data:P(e)})}function fe(e){return W({url:ge+"setBookCollect/",method:"POST",data:P(e)})}function _e(e){return W({url:ge+"getChapterContent/",method:"POST",data:P(e)})}function ye(e){return W({url:ge+"addBookHistory/",method:"POST",data:P(e)})}function be(e){return W({url:ge+"getBookHistory/",method:"POST",data:P(e)})}function Ce(e){return W({url:ge+"getBookCollections/",method:"POST",data:P(e)})}function Ie(e){return W({url:ge+"deleteBookCollections/",method:"POST",data:P(e)})}function Se(e){return W({url:ge+"deleteBookHistory/",method:"POST",data:P(e)})}var xe={name:"bookHomePage",data(){return{homeBooks:[],loadingPage:!0,swipeImages:["https://f2.kkmh.com/image/220412/GAIafzm3C.png-t.w1125.png.h","https://f2.kkmh.com/image/220412/GAIafzm3C.png-t.w1125.png.h","https://f2.kkmh.com/image/220412/GAIafzm3C.png-t.w1125.png.h"]}},methods:{async init(){await pe().then((e=>this.homeBooks=e.data))},openBook(e){console.log(e),we({book_url:e}).then((e=>{localStorage.setItem("currentBookInfo",e.data),this.$router.push("/bookInfo/"+e.data.id)}))}},created(){this.init()}};const We=(0,r.Z)(xe,[["render",me],["__scopeId","data-v-963cc99a"]]);var Pe=We,De={name:"HomePage",components:{BookHomePage:Pe,MangaHomePage:ie},data(){return{title:"主页",searchText:"搜索作品名",showMenu:!1,activePage:0,images:[],testApi(){let e={chapter_url:"http://www.ykmh.com/manhua/kexuecunzaiderenwainiangguanchariji/34754.html"};D(e).then((e=>{console.log(e)}))}}},methods:{init(){window.scrollTo(0,1),this.showMenu=!1}},created(){this.init()},activated(){console.log("加载缓存界面：主页")},deactivated(){}};const Le=(0,r.Z)(De,[["render",C],["__scopeId","data-v-55d851dc"]]);var Te=Le;const He={style:{display:"flex",height:"100%",width:"100%","align-items":"center"}},Oe={style:{margin:"16px"}},ze=(0,a.Uk)(" 提交 ");function Me(e,t,i,o,n,s){const l=(0,a.up)("van-field"),r=(0,a.up)("van-cell-group"),c=(0,a.up)("van-button"),d=(0,a.up)("van-form");return(0,a.wg)(),(0,a.iD)("div",He,[(0,a.Wm)(d,{onSubmit:s.onSubmit,style:{width:"100%"}},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{inset:""},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{modelValue:n.loginForm.username,"onUpdate:modelValue":t[0]||(t[0]=e=>n.loginForm.username=e),name:"username",label:"用户名",placeholder:"用户名",rules:[{required:!0,message:"请填写用户名"}]},null,8,["modelValue"]),(0,a.Wm)(l,{modelValue:n.loginForm.password,"onUpdate:modelValue":t[1]||(t[1]=e=>n.loginForm.password=e),type:"password",name:"password",label:"密码",placeholder:"密码",rules:[{required:!0,message:"请填写密码"}]},null,8,["modelValue"])])),_:1}),(0,a._)("div",Oe,[(0,a.Wm)(c,{round:"",block:"",type:"primary","native-type":"submit"},{default:(0,a.w5)((()=>[ze])),_:1}),(0,a._)("div",{style:{width:"100%","text-align":"right","margin-top":"10px",color:"dodgerblue"},onClick:t[2]||(t[2]=e=>this.$router.push("/register"))}," 没有账号？去注册 ")])])),_:1},8,["onSubmit"])])}const $e="/user/";function Fe(e){return W({url:$e+"login/",method:"POST",data:P(e)})}function Ve(e){return W({url:$e+"register/",method:"POST",data:P(e)})}const Be=0,qe=1,Ee=2,Ne=3;var Ue={SUCCESS_CODE:Be,FAIL_CODE:qe,ERROR_CODE:Ee,TIMEOUT_CODE:Ne},je={name:"loginPage",data(){return{loginForm:{username:"",password:""},user:{}}},methods:{onSubmit(e){Fe({username:e.username,password:e.password}).then((e=>{e.code===Ue.SUCCESS_CODE?(this.$user=e.data,console.log(this.$user),localStorage.setItem("user",JSON.stringify(e.data)),this.$router.push("/home")):m.F.fail(e.msg)}))}},created(){}};const Ye=(0,r.Z)(je,[["render",Me]]);var Ae=Ye;const Je={style:{display:"flex",height:"100%",width:"100%","align-items":"center"}},Ke={style:{margin:"16px"}},Ze=(0,a.Uk)(" 提交 ");function Qe(e,t,i,o,n,s){const l=(0,a.up)("van-field"),r=(0,a.up)("van-cell-group"),c=(0,a.up)("van-button"),d=(0,a.up)("van-form");return(0,a.wg)(),(0,a.iD)("div",Je,[(0,a.Wm)(d,{onSubmit:s.onSubmit,style:{width:"100%"}},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{inset:""},{default:(0,a.w5)((()=>[(0,a.Wm)(l,{modelValue:n.registerForm.username,"onUpdate:modelValue":t[0]||(t[0]=e=>n.registerForm.username=e),name:"username",label:"用户名",placeholder:"用户名",rules:[{required:!0,message:"请填写用户名"}]},null,8,["modelValue"]),(0,a.Wm)(l,{modelValue:n.registerForm.password,"onUpdate:modelValue":t[1]||(t[1]=e=>n.registerForm.password=e),type:"password",name:"password",label:"密码",placeholder:"密码",rules:[{required:!0,message:"请填写密码"}]},null,8,["modelValue"]),(0,a.Wm)(l,{modelValue:n.registerForm.rePassword,"onUpdate:modelValue":t[2]||(t[2]=e=>n.registerForm.rePassword=e),type:"password",name:"rePassword",label:"确认密码",placeholder:"再次输入密码",rules:[{required:!0,message:"请确认密码"}]},null,8,["modelValue"]),(0,a.Wm)(l,{modelValue:n.registerForm.nickName,"onUpdate:modelValue":t[3]||(t[3]=e=>n.registerForm.nickName=e),name:"nickName",label:"昵称",placeholder:"你的昵称",rules:[{required:!0,message:"请输入昵称"}]},null,8,["modelValue"]),(0,a.Wm)(l,{modelValue:n.registerForm.email,"onUpdate:modelValue":t[4]||(t[4]=e=>n.registerForm.email=e),name:"email",type:"email",label:"邮箱",placeholder:"邮箱",rules:[{required:!0,message:"请填写邮箱"}]},null,8,["modelValue"])])),_:1}),(0,a._)("div",Ke,[(0,a.Wm)(c,{round:"",block:"",type:"primary","native-type":"submit"},{default:(0,a.w5)((()=>[Ze])),_:1})])])),_:1},8,["onSubmit"])])}var Re={name:"registerPage",data(){return{registerForm:{username:"",password:"",rePassword:"",nickName:"",email:""},user:{}}},methods:{onSubmit(e){Ve(e).then((e=>{this.user=e.data,console.log(e.data),0===e.code?(this.$user=e.data,localStorage.setItem("user",JSON.stringify(e.data)),this.$router.push("/home")):m.F.fail(e.msg)}))}}};const Ge=(0,r.Z)(Re,[["render",Qe]]);var Xe=Ge;const et=e=>((0,a.dD)("data-v-98041460"),e=e(),(0,a.Cn)(),e),tt={id:"head-group"},it={style:{"margin-left":"5px"}},ot=et((()=>(0,a._)("div",{style:{margin:"10px 0 0 10px",color:"#999999","font-size":"12px"}},"搜索历史",-1))),at={id:"search-history-group"};function nt(e,t,i,n,s,l){const r=(0,a.up)("van-icon"),c=(0,a.up)("van-search"),d=(0,a.up)("van-sticky"),h=(0,a.up)("van-tag"),u=(0,a.up)("van-picker"),m=(0,a.up)("van-popup"),g=(0,a.up)("manga-search-page");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(d,{"z-index":"45"},{default:(0,a.w5)((()=>[(0,a._)("div",tt,[(0,a.Wm)(c,{modelValue:s.searchText,"onUpdate:modelValue":t[2]||(t[2]=e=>s.searchText=e),"show-action":"","left-icon":"arrow-down",style:{height:"100%",flexGrow:1},placeholder:"请输入搜索关键词",onSearch:l.onSearch,onCancel:t[3]||(t[3]=e=>this.$router.back())},{label:(0,a.w5)((()=>[(0,a._)("div",{onClick:[t[0]||(t[0]=(...e)=>l.onClickButton&&l.onClickButton(...e)),t[1]||(t[1]=(0,o.iM)((()=>{}),["prevent"]))]},(0,L.zw)(s.type[s.pickType].text),1)])),"left-icon":(0,a.w5)((()=>[(0,a.Wm)(r,{name:"arrow-down",onClick:l.onClickButton},null,8,["onClick"])])),_:1},8,["modelValue","onSearch"])])])),_:1}),(0,a.wy)((0,a._)("div",it,[ot,(0,a._)("div",at,[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)(10,(e=>(0,a.Wm)(h,{key:e,show:s.show[e],color:"rgba(0,0,0,0.1)","text-color":"black",class:"search-history-item",closeable:"",size:"medium",type:"primary",onClose:t=>s.show[e]=!1},{default:(0,a.w5)((()=>[(0,a.Uk)(" 标签"+(0,L.zw)(e),1)])),_:2},1032,["show","onClose"]))),64))])],512),[[o.F8,!s.isSearch]]),(0,a.Wm)(m,{show:s.showPicker,"onUpdate:show":t[5]||(t[5]=e=>s.showPicker=e),position:"bottom"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{columns:s.type,title:"选择搜索类型",onConfirm:l.selectType,onCancel:t[4]||(t[4]=e=>s.showPicker=!1)},null,8,["columns","onConfirm"])])),_:1},8,["show"]),s.isSearch?((0,a.wg)(),(0,a.j4)(g,{key:0,"search-count":s.searchCount,keywords:s.searchText},null,8,["search-count","keywords"])):(0,a.kq)("",!0)])}const st=e=>((0,a.dD)("data-v-60f89c66"),e=e(),(0,a.Cn)(),e),lt={style:{"overflow-x":"hidden"}},rt=["onClick"],ct=["src"],dt={class:"history-info"},ht={class:"van-ellipsis"},ut=["innerHTML"],mt=["innerHTML"],gt=st((()=>(0,a._)("div",null,null,-1))),pt=st((()=>(0,a._)("div",null,"最后更新章节",-1))),wt=["innerHTML"];function vt(e,t,i,n,s,l){const r=(0,a.up)("van-empty");return(0,a.wg)(),(0,a.iD)(a.HY,null,[l.isEmpty?((0,a.wg)(),(0,a.j4)(r,{key:0,description:"什么也没有搜到（；´д｀）ゞ"})):(0,a.kq)("",!0),(0,a.wy)((0,a._)("div",lt,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.mangaList,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{key:t},[(0,a._)("div",{class:"history-item van-hairline--bottom",onClick:e=>l.openManga(t)},[(0,a._)("div",null,[(0,a._)("img",{class:"history-img",src:e.image_url},null,8,ct)]),(0,a._)("div",dt,[(0,a._)("div",ht,[(0,a._)("b",{innerHTML:e.title},null,8,ut)]),(0,a._)("div",{innerHTML:e.author},null,8,mt),gt,pt,(0,a._)("div",{innerHTML:e.last_chapter},null,8,wt)])],8,rt)])))),128))],512),[[o.F8,!s.loadingPage&&!l.isEmpty]])],64)}var kt={name:"mangaSearchPage",props:["keywords","searchCount"],data(){return{loadingPage:!0,page:1,mangaList:[]}},methods:{async init(){m.F.loading({message:"获取浏览历史中...",duration:0}),this.loadingPage=!0,await X({keywords:this.keywords,page:this.page}).then((e=>{let t=JSON.stringify(e.data).replaceAll(this.keywords,"<span style='color:lightskyblue'>"+this.keywords+"</span>");this.mangaList=JSON.parse(t)})),this.loadingPage=!1,m.F.clear()},async openManga(e){m.F.loading({message:"爬取漫画信息中...",duration:0});const t=this.mangaList[e];await U({manga_url:t.manga_url}).then((e=>{m.F.clear(),localStorage.setItem("currentMangaInfo",JSON.stringify(e.data)),this.$router.push("/mangaInfo/"+e.data.id)}))}},computed:{isEmpty(){return!this.mangaList||0===this.mangaList.length}},watch:{searchCount(){console.log(1),this.init()}},created(){this.init()}};const ft=(0,r.Z)(kt,[["render",vt],["__scopeId","data-v-60f89c66"]]);var _t=ft,yt={name:"searchPage",components:{MangaSearchPage:_t},data(){return{searchText:"",showPicker:!1,isSearch:!1,searchCount:0,type:[{text:"漫画"},{text:"小说",disabled:!1}],pickType:0,show:[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],showSearch:!1}},methods:{onClickButton(){this.showPicker=!0},onSearch(){this.isSearch=!0,this.searchCount++},selectType(e,t){console.log(`当前值：${e}, 当前索引：${t}`),this.pickType=t,this.showPicker=!1}}};const bt=(0,r.Z)(yt,[["render",nt],["__scopeId","data-v-98041460"]]);var Ct=bt;const It=e=>((0,a.dD)("data-v-d0c51cb6"),e=e(),(0,a.Cn)(),e),St={key:0,style:{"overflow-x":"hidden"}},xt={id:"info-group"},Wt={id:"info-img-group"},Pt={id:"info-text-group"},Dt={key:0},Lt={key:1},Tt={id:"info-button-group"},Ht=It((()=>(0,a._)("span",null,"开始阅读",-1))),Ot=[Ht],zt={class:"chapter-list-title-group"},Mt=["onClick"],$t={class:"chapter-list"},Ft=["onClick"],Vt={key:0},Bt={class:"van-ellipsis"},qt={class:"van-ellipsis"},Et=It((()=>(0,a._)("div",null,"新!",-1)));function Nt(e,t,i,o,n,s){const l=(0,a.up)("van-share-sheet"),r=(0,a.up)("van-icon"),c=(0,a.up)("van-nav-bar"),d=(0,a.up)("van-image"),h=(0,a.up)("van-badge");return n.loadingPage?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",St,[(0,a.Wm)(l,{show:n.showShare,"onUpdate:show":t[0]||(t[0]=e=>n.showShare=e),title:"立即分享给好友",options:n.shareOptions},null,8,["show","options"]),(0,a.Wm)(c,{title:n.mangaInfo.title,"left-text":"返回","left-arrow":""},{left:(0,a.w5)((()=>[(0,a.Wm)(r,{name:"arrow-left",size:"18",color:"black",onClick:t[1]||(t[1]=e=>this.$router.back())})])),right:(0,a.w5)((()=>[(0,a.Wm)(r,{onClick:t[2]||(t[2]=e=>n.showShare=!0),name:"share-o",size:"18",color:"black"})])),_:1},8,["title"]),(0,a._)("div",xt,[(0,a._)("div",Wt,[(0,a.Wm)(d,{radius:"5",height:"150",width:"112.5",fit:"fill",src:n.mangaInfo.image_url},null,8,["src"])]),(0,a._)("div",Pt,[(0,a._)("div",null,[(0,a.Wm)(r,{name:"user-o"}),(0,a._)("span",null,(0,L.zw)(n.mangaInfo.author.name),1)]),(0,a._)("div",null,[(0,a.Wm)(r,{name:"description"}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.mangaInfo.tags,((e,t)=>((0,a.wg)(),(0,a.iD)("span",{key:t},(0,L.zw)(e.name),1)))),128))]),(0,a._)("div",null,[(0,a.Wm)(r,{name:"description"}),(0,a._)("span",null,(0,L.zw)(n.mangaInfo.category.name),1)]),(0,a._)("div",null,[(0,a.Wm)(r,{name:"edit"}),(0,a._)("span",null,(0,L.zw)(n.mangaInfo.status),1)]),(0,a._)("div",null,[(0,a.Wm)(r,{name:"clock-o"}),0===n.mangaHistory.is_read?((0,a.wg)(),(0,a.iD)("span",Dt,"还没有阅读过该漫画")):(0,a.kq)("",!0),1===n.mangaHistory.is_read?((0,a.wg)(),(0,a.iD)("span",Lt,"上次读到:"+(0,L.zw)(n.mangaHistory.last_read_chapter),1)):(0,a.kq)("",!0)]),(0,a._)("div",Tt,[(0,a._)("div",{id:"read-button",onClick:t[3]||(t[3]=(...e)=>s.startRead&&s.startRead(...e))},Ot),(0,a._)("div",{id:"collect-button",onClick:t[4]||(t[4]=(...e)=>s.setCollect&&s.setCollect(...e))},[(0,a._)("span",null,(0,L.zw)(s.collectStatus),1)])])])]),(0,a._)("div",{id:"detail-group",onClick:t[5]||(t[5]=e=>n.hiddenDetail=!n.hiddenDetail),class:(0,L.C_)(n.hiddenDetail?"detail-hidden":"")}," 简介:"+(0,L.zw)(n.mangaInfo.detail),3),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.mangaChapterList,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"chapter-group",key:t},[(0,a._)("div",zt,[(0,a._)("div",null,[(0,a.Wm)(r,{name:"bookmark-o"}),(0,a._)("b",null,(0,L.zw)(e.title),1)]),(0,a._)("div",{onClick:e=>s.orderList(t),class:(0,L.C_)(0===n.orderType[t]?"chapter-order":"")},[(0,a.Uk)(" 排序方式:"+(0,L.zw)(0===n.orderType[t]?"倒序":"正序")+" ",1),(0,a.Wm)(r,{name:"exchange"})],10,Mt)]),(0,a._)("div",$t,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.chapter_list,((e,i)=>((0,a.wg)(),(0,a.iD)("div",{class:"chapter-item",key:i,onClick:e=>s.openChapter(t,i)},[s.isNewChapter(t,i)?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",Vt,[(0,a._)("div",Bt,(0,L.zw)(e.name),1)])),s.isNewChapter(t,i)?((0,a.wg)(),(0,a.j4)(h,{key:1,offset:[-5,3]},{content:(0,a.w5)((()=>[Et])),default:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a._)("div",qt,(0,L.zw)(e.name),1)])])),_:2},1024)):(0,a.kq)("",!0)],8,Ft)))),128)),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.blankNum(t),(e=>((0,a.wg)(),(0,a.iD)("div",{class:"blank-item",key:e})))),128))])])))),128))]))}var Ut=i(2317),jt={name:"mangaInfoPage",data(){return{loadingPage:!0,mangaInfo:{},mangaChapterList:[],mangaHistory:{},showShare:!1,shareOptions:[{name:"微信",icon:"wechat"},{name:"朋友圈",icon:"wechat-moments"},{name:"微博",icon:"weibo"},{name:"QQ",icon:"qq"},{name:"复制链接",icon:"link"},{name:"分享海报",icon:"poster"},{name:"二维码",icon:"qrcode"},{name:"小程序码",icon:"weapp-qrcode"}],hiddenDetail:!0,orderType:[]}},methods:{async init(){m.F.loading({message:"加载信息中",duration:0}),this.loadingPage=!0,await U({manga_id:this.$route.params.id}).then((e=>{localStorage.setItem("currentMangaInfo",JSON.stringify(e.data)),this.mangaInfo=e.data})),await j({manga_url:this.mangaInfo.manga_url}).then((e=>{localStorage.setItem("currentMangaChapterList",JSON.stringify(e.data)),this.mangaChapterList=e.data}));const e=this.$user.id;await Y({user_id:e,manga_id:this.mangaInfo.id}).then((e=>{this.mangaHistory=e.data}));for(let t=0;t<this.mangaChapterList.length;t++)this.orderType.push(1);this.loadingPage=!1,m.F.clear()},blankNum(e){return 4-this.mangaChapterList[e].chapter_list.length%4},isNewChapter(e,t){const i=this.mangaChapterList[e].chapter_list,o=this.orderType[e],a=0===o?0:i.length-1;return t===a},orderList(e){this.orderType[e]=0===this.orderType[e]?1:0,this.mangaChapterList[e].chapter_list.reverse()},openChapter(e,t){0===this.orderType[e]?this.$router.push("/mangaView/"+e+"/"+(this.mangaChapterList[e].chapter_list.length-t-1)):this.$router.push("/mangaView/"+e+"/"+t)},startRead(){this.mangaHistory&&Ut.V.confirm({title:"提示",message:"上次看到"+this.mangaHistory.last_read_chapter+",是否继续阅读？"}).then((()=>{})).catch((()=>{}))},async setCollect(){console.log(this.$user),this.mangaHistory||await A({user_id:this.$user.id,manga_id:this.mangaInfo.id}).then((e=>this.mangaHistory=e.data));const e=this.mangaHistory.collect,t=t=>new Promise((i=>{"confirm"===t?J({user_id:this.$user.id,manga_id:this.mangaInfo.id,collect:0===e?1:0}).then((e=>{localStorage.setItem("currentMangaHistory",JSON.stringify(e.data)),this.mangaHistory=e.data,i(!0)})):i(!0)}));Ut.V.confirm({title:"提示",message:0===e?"确认将该漫画加入书架吗？":"确认将该漫画从书架中移除吗？",beforeClose:t})}},computed:{collectStatus(){return 0===this.mangaHistory.collect?"加入书架":"移出书架"}},created(){this.init()},activated(){console.log(parseInt(this.$route.params.id),this.mangaInfo.id),parseInt(this.$route.params.id)!==this.mangaInfo.id?this.init():(window.scrollTo(0,0),console.log("缓存页面:漫画信息页"))}};const Yt=(0,r.Z)(jt,[["render",Nt],["__scopeId","data-v-d0c51cb6"]]);var At=Yt;const Jt={key:0,style:{"overflow-y":"hidden"}},Kt={key:0,id:"view-head"},Zt={id:"view-head-left"},Qt={id:"view-head-content"},Rt={id:"view-head-right"},Gt={id:"view-content",style:{"overflow-y":"hidden"}},Xt={id:"view-foot-info-left"},ei={id:"view-foot-info-right"},ti={key:0,id:"brightness-group"},ii={key:0,id:"view-foot"},oi={class:"slider-group"},ai={id:"view-foot-button-group"},ni=["onClick"],si={style:{"margin-top":"5px"}},li={id:"chapter-group"},ri={class:"van-hairline--bottom"},ci=["id"],di=(0,a.Uk)("当前章节"),hi=(0,a.Uk)("阅读该话 ");function ui(e,t,i,n,s,l){const r=(0,a.up)("van-share-sheet"),c=(0,a.up)("van-icon"),d=(0,a.up)("van-loading"),h=(0,a.up)("van-image"),u=(0,a.up)("van-slider"),m=(0,a.up)("van-tag"),g=(0,a.up)("van-button"),p=(0,a.up)("van-action-sheet");return s.loadingPage?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",Jt,[(0,a.Wm)(r,{show:s.showShare,"onUpdate:show":t[0]||(t[0]=e=>s.showShare=e),title:"立即分享给好友",options:s.shareOptions},null,8,["show","options"]),(0,a.Wm)(o.uT,{name:"van-slide-down"},{default:(0,a.w5)((()=>[s.showMenu?((0,a.wg)(),(0,a.iD)("div",Kt,[(0,a._)("div",Zt,[(0,a.Wm)(c,{name:"arrow-left",size:"18",onClick:t[1]||(t[1]=e=>this.$router.back())})]),(0,a._)("div",Qt,(0,L.zw)(s.chapters[s.chapterIndex].name),1),(0,a._)("div",Rt,[(0,a.Wm)(c,{onClick:t[2]||(t[2]=e=>s.showShare=!0),name:"share-o",size:"18"})])])):(0,a.kq)("",!0)])),_:1}),(0,a._)("div",Gt,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.images,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{key:t,style:(0,L.j5)({filter:"brightness("+s.settings.brightness+"%)"})},[(0,a.Wm)(h,{width:"100vw",onClick:e=>l.openMenu(t),onTouchmove:e=>s.imageIndex=t,fit:"fill",src:e,id:"image_"+t,"lazy-load":"",style:{display:"block"}},{loading:(0,a.w5)((()=>[(0,a.Wm)(d,{type:"spinner",size:"20"})])),_:2},1032,["onClick","onTouchmove","src","id"])],4)))),128))]),s.loadingPage?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",{key:0,id:"view-foot-info",style:(0,L.j5)({bottom:s.showMenu?"135px":0})},[(0,a._)("div",Xt,[(0,a._)("div",null,(0,L.zw)(s.browserNameVersion),1),(0,a._)("div",null,(0,L.zw)(s.time),1)]),(0,a._)("div",ei,[(0,a._)("div",null,(0,L.zw)(s.chapter.name),1),(0,a._)("div",null,(0,L.zw)(s.imageIndex+1+"/"+s.images.length),1)])],4)),(0,a.Wm)(o.uT,{name:"van-fade"},{default:(0,a.w5)((()=>[s.showBrightness?((0,a.wg)(),(0,a.iD)("div",ti,[(0,a.Wm)(c,{name:"closed-eye"}),(0,a.Wm)(u,{modelValue:s.settings.brightness,"onUpdate:modelValue":t[3]||(t[3]=e=>s.settings.brightness=e),"bar-height":"5px"},null,8,["modelValue"]),(0,a.Wm)(c,{name:"eye-o"})])):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(o.uT,{name:"van-slide-up"},{default:(0,a.w5)((()=>[s.showMenu?((0,a.wg)(),(0,a.iD)("div",ii,[(0,a._)("div",oi,[(0,a._)("div",{onClick:t[4]||(t[4]=e=>l.openChapter(s.chapterIndex-1))},"上一话"),(0,a.Wm)(u,{modelValue:s.imageIndex,"onUpdate:modelValue":t[5]||(t[5]=e=>s.imageIndex=e),max:s.images.length-1,"bar-height":"5px",onChange:t[6]||(t[6]=e=>l.onImageSliderChange())},null,8,["modelValue","max"]),(0,a._)("div",{onClick:t[7]||(t[7]=e=>l.openChapter(s.chapterIndex+1))},"下一话")]),(0,a._)("div",ai,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.footButtons,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"view-foot-button-item",key:t,onClick:e=>l.btnClick(t),style:(0,L.j5)({color:e.color})},[(0,a.Wm)(o.uT,{name:"van-fade"},{default:(0,a.w5)((()=>[e.loading?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(c,{key:0,size:"25",color:e.icon_color,name:e.icon,badge:e.badge},null,8,["color","name","badge"]))])),_:2},1024),(0,a.Wm)(o.uT,{name:"van-fade"},{default:(0,a.w5)((()=>[(0,a._)("div",si,(0,L.zw)(e.text),1)])),_:2},1024)],12,ni)))),128))])])):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(p,{show:s.showChapterList,"onUpdate:show":t[9]||(t[9]=e=>s.showChapterList=e),style:{"background-color":"black",color:"white",height:"70%"}},{default:(0,a.w5)((()=>[(0,a._)("div",li,[(0,a._)("div",ri,[(0,a._)("div",null,"全部章节("+(0,L.zw)(s.chapters.length)+")",1),(0,a._)("div",{style:(0,L.j5)({color:s.chapterListOrder?"#1989fa":"white"}),onClick:t[8]||(t[8]=e=>s.chapterListOrder=!s.chapterListOrder)},[(0,a._)("div",null,(0,L.zw)(s.chapterListOrder?"倒序":"正序"),1),(0,a.Wm)(c,{name:"exchange"})],4)]),(0,a._)("div",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.chapters,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{key:t,id:"chapter_"+t,class:"van-hairline--bottom chapter-item"},[(0,a._)("span",null,[(0,a.Uk)((0,L.zw)(e.name)+" ",1),t===s.chapterIndex?((0,a.wg)(),(0,a.j4)(m,{key:0,plain:"",type:"primary",style:(0,L.j5)({"background-color":"rgba(0,0,0,0"})},{default:(0,a.w5)((()=>[di])),_:1},8,["style"])):(0,a.kq)("",!0)]),(0,a.Wm)(g,{plain:"",color:"white",size:"small",style:(0,L.j5)({"background-color":"rgba(0,0,0,0)"}),icon:"arrow","icon-position":"right",onClick:e=>l.openChapter(t)},{default:(0,a.w5)((()=>[hi])),_:2},1032,["style","onClick"])],8,ci)))),128))])])])),_:1},8,["show"])]))}function mi(){var e,t={},i=navigator.userAgent.toLowerCase();return(e=i.match(/rv:([\d.]+)\) like gecko/))||(e=i.match(/msie ([\d\.]+)/))?t.ie=e[1]:(e=i.match(/edge\/([\d\.]+)/))?t.edge=e[1]:(e=i.match(/firefox\/([\d\.]+)/))?t.firefox=e[1]:(e=i.match(/(?:opera|opr).([\d\.]+)/))?t.opera=e[1]:(e=i.match(/chrome\/([\d\.]+)/))?t.chrome=e[1]:(e=i.match(/version\/([\d\.]+).*safari/))&&(t.safari=e[1]),t.ie?"IE "+t.ie:t.edge?"EDGE "+t.edge:t.firefox?"Firefox "+t.firefox:t.chrome?"Chrome "+t.chrome:t.opera?"Opera "+t.opera:t.safari?"Safari "+t.safari:"Unkonwn"}var gi={name:"mangaViewPage",data(){return{loadingPage:!0,showMenu:!1,mangaHistory:{},chapters:[],chapter:{},images:[],imageIndex:0,chapterIndex:0,footButtons:[],settings:{brightness:100},showBrightness:!1,showChapterList:!1,chapterListOrder:!1,time:"",browserNameVersion:mi(),showShare:!1,shareOptions:[{name:"微信",icon:"wechat"},{name:"朋友圈",icon:"wechat-moments"},{name:"微博",icon:"weibo"},{name:"QQ",icon:"qq"},{name:"复制链接",icon:"link"},{name:"分享海报",icon:"poster"},{name:"二维码",icon:"qrcode"},{name:"小程序码",icon:"weapp-qrcode"}]}},methods:{openMenu(e){this.showBrightness=!1,this.showMenu=!this.showMenu,this.imageIndex=e,console.log(e)},onImageSliderChange(){const e=document.querySelector("#image_"+this.imageIndex);e.scrollIntoView()},btnClick(e){this[this.footButtons[e]["clickable"]](e)},setCollect(e){const t=0===this.mangaHistory.collect,i=JSON.parse(localStorage.getItem("currentMangaInfo"));this.footButtons[e]["loading"]=!0,J({user_id:this.$user.id,manga_id:i.id,collect:t?1:0}).then((i=>{localStorage.setItem("currentMangaHistory",JSON.stringify(i.data)),this.mangaHistory=i.data,this.footButtons[e]["text"]=t?"已收藏":"收藏",this.footButtons[e]["icon"]=t?"star":"star-o",this.footButtons[e]["icon_color"]=t?"yellow":"",delete this.footButtons[e]["loading"],console.log("setCollect")}))},setBrightness(e){this.showMenu=!1,this.showBrightness=!0,console.log("setBrightness",e)},openCommentList(e){this.$Toast.fail("暂未开通此功能,敬请期待"),console.log("openCommentList",e)},openChapterList(e){this.showMenu=!1,this.showChapterList=!0;var t=setInterval((()=>{const e=document.querySelector("#chapter_"+this.chapterIndex);null!==e&&(e.scrollIntoView(),clearInterval(t))}),500);console.log("openChapterList",e)},openChapter(e){this.chapterListOrder&&(this.chapterListOrder=!1,e=this.chapters.length-e-1),console.log(e),e<0?m.F.fail("已经是第一章了"):e>this.chapters.length-1?m.F.fail("没有更多章节了"):(console.log(e),this.$router.replace("/mangaView/"+this.$route.params.listIndex+"/"+e))},getTime(){const e=new Date;this.time=e.getMonth()+"-"+e.getDay()+" "+e.getHours()+":"+e.getMinutes()},async init(){this.loadingPage=!0,this.showMenu=!1,this.showChapterList=!1,this.chapterListOrder=!1,this.imageIndex=0,this.getTime(),setInterval(this.getTime,1e3);const e=this.$route.params.listIndex;this.chapters=JSON.parse(localStorage.getItem("currentMangaChapterList"))[e].chapter_list,this.chapterIndex=parseInt(this.$route.params.chapterIndex),this.chapter=this.chapters[this.chapterIndex],await K({chapter_url:this.chapter.url}).then((e=>{this.images=e.data})),await A({user_id:this.$user.id,manga_id:JSON.parse(localStorage.getItem("currentMangaInfo")).id,last_read_chapter:this.chapter.name,last_read_url:this.chapter.url}).then((e=>{localStorage.setItem("currentMangaHistory",JSON.stringify(e.data)),this.mangaHistory=e.data}));const t=this.mangaHistory.collect;this.footButtons=[{text:t?"已收藏":"收藏",icon:t?"star":"star-o",icon_color:t?"yellow":"",active:!1,clickable:"setCollect"},{text:"亮度",icon:"eye-o",active:!1,clickable:"setBrightness"},{text:"评论",icon:"comment-o",badge:"99+",active:!1,clickable:"openCommentList"},{text:"章节",icon:"orders-o",active:!1,clickable:"openChapterList"}],this.loadingPage=!1,m.F.clear()}},watch:{$route(){"/mangaView"===this.$route.fullPath.substring(0,10)&&(m.F.loading({message:"加载图片中",duration:0}),this.init(),document.getElementById("image_0").scrollIntoView())},chapterListOrder(){console.log("setOrder"),this.chapters.reverse(),this.chapterIndex=this.chapters.length-this.chapterIndex-1;const e=document.querySelector("#chapter_0");e.scrollIntoView()},showChapterList(){this.showChapterList||(this.chapterListOrder=!1)}},created(){m.F.loading({message:"加载图片中",duration:0}),this.init()}};const pi=(0,r.Z)(gi,[["render",ui],["__scopeId","data-v-92653eac"]]);var wi=pi;const vi=(0,a.Uk)(" 点击右上角可以编辑书架哦！ ");function ki(e,t,i,o,n,s){const l=(0,a.up)("van-icon"),r=(0,a.up)("van-nav-bar"),c=(0,a.up)("van-sticky"),d=(0,a.up)("van-notice-bar"),h=(0,a.up)("manga-collection-page"),u=(0,a.up)("van-tab"),m=(0,a.up)("book-collection-page"),g=(0,a.up)("van-tabs");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r,{title:"我的书架","left-text":"返回","left-arrow":"",style:{height:"50px"}},{left:(0,a.w5)((()=>[(0,a.Wm)(l,{name:"arrow-left",size:"18",color:"black",onClick:t[0]||(t[0]=e=>this.$router.back())})])),right:(0,a.w5)((()=>[(0,a.Wm)(l,{onClick:t[1]||(t[1]=e=>n.isEdit=!n.isEdit),name:"filter-o",size:"20",color:n.isEdit?"#1989fa":"black"},null,8,["color"])])),_:1})])),_:1}),(0,a.Wm)(d,{color:"#1989fa",background:"#ecf9ff",style:{fontSize:"14px",marginBottom:"10px"},mode:"closeable"},{"left-icon":(0,a.w5)((()=>[(0,a.Wm)(l,{name:"info-o",size:"16",style:{"margin-right":"10px"}})])),default:(0,a.w5)((()=>[vi])),_:1}),(0,a.Wm)(g,{active:n.active,"onUpdate:active":t[2]||(t[2]=e=>n.active=e),type:"card",color:"#999999",onClickTab:t[3]||(t[3]=e=>n.isEdit=!1)},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{title:"漫画"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{isEdit:n.isEdit,onSetEdit:s.setEdit},null,8,["isEdit","onSetEdit"])])),_:1}),(0,a.Wm)(u,{title:"小说"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{isEdit:n.isEdit,onSetEdit:s.setEdit},null,8,["isEdit","onSetEdit"])])),_:1})])),_:1},8,["active"])],64)}const fi={style:{"overflow-x":"hidden"}},_i={key:0,class:"grid"},yi=["onClick"],bi=["onClick"],Ci={class:"grid-selected"},Ii={class:"manga-title"},Si={class:"manga-tag"},xi={id:"foot-group",class:"van-hairline--top"};function Wi(e,t,i,n,s,l){const r=(0,a.up)("van-checkbox"),c=(0,a.up)("van-image"),d=(0,a.up)("van-empty");return(0,a.wg)(),(0,a.iD)("div",fi,[l.isEmpty||s.loadingPage?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",_i,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.collections,((e,t)=>(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",{class:"grid-item",onClick:e=>l.mangaClick(t),key:t},[(0,a.Wm)(c,{radius:"10",height:"160",width:"120",src:e.manga.image_url,style:{position:"relative"}},{default:(0,a.w5)((()=>[(0,a.wy)((0,a._)("div",{onClick:e=>s.selected[t]=!s.selected[t],class:"grid-cover"},null,8,bi),[[o.F8,i.isEdit]]),(0,a.wy)((0,a._)("div",Ci,[(0,a.Wm)(r,{modelValue:s.selected[t],"onUpdate:modelValue":e=>s.selected[t]=e},null,8,["modelValue","onUpdate:modelValue"])],512),[[o.F8,i.isEdit]])])),_:2},1032,["src"]),(0,a._)("div",Ii,(0,L.zw)(e.manga.title),1),(0,a.wy)((0,a._)("div",{class:"manga-tag van-ellipsis"},(0,L.zw)("看到"+e.last_read_chapter),513),[[o.F8,1===e.is_read]]),(0,a.wy)((0,a._)("div",Si,"未阅读过该漫画",512),[[o.F8,0===e.is_read]])],8,yi)),[[o.F8,1===e.collect]]))),128))])),(0,a.Wm)(o.uT,{name:"van-slide-up"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a._)("div",xi,[(0,a._)("div",{onClick:t[0]||(t[0]=(...e)=>l.selectAll&&l.selectAll(...e))},(0,L.zw)(l.isSelectAll?"取消全选":"全选(已选"+l.isSelectedNum+"/"+s.selected.length+")"),1),(0,a._)("div",{onClick:t[1]||(t[1]=(...e)=>l.deleteCollections&&l.deleteCollections(...e)),style:{color:"red"}},"删除")],512),[[o.F8,i.isEdit]])])),_:1}),l.isEmpty?((0,a.wg)(),(0,a.j4)(d,{key:1,description:"这里什么都没有(っ °Д °;)っ"})):(0,a.kq)("",!0)])}var Pi={name:"mangaCollectionPage",props:["isEdit"],data(){return{loadingPage:!0,collections:[],selected:[]}},methods:{async init(){m.F.loading({message:"获取书架信息中...",duration:0}),this.loadingPage=!0,this.$emit("setEdit",!1),this.selected=[];const e=this.$user.id;await R({user_id:e}).then((e=>{this.collections=e.data;for(let t=0;t<this.collections.length;t++)this.selected.push(!1)})),this.loadingPage=!1,m.F.clear()},mangaClick(e){this.isEdit||(localStorage.setItem("currentMangaInfo",JSON.stringify(this.collections[e])),this.$router.push("/mangaInfo/"+this.collections[e].manga.id))},selectAll(){const e=this.isSelectAll;for(let t=0;t<this.collections.length;t++)this.selected[t]=!e},deleteCollections(){0!==this.isSelectedNum?(Ut.V.confirm({title:"提示",message:"确定要将这些漫画从书架中移除吗？"}).then((()=>{const e=this.$user.id,t=[];for(let i in this.selected)this.selected[i]&&t.push(this.collections[i].id);console.log(t),G({user_id:e,delete_list:JSON.stringify(t)}).then((()=>this.init()))})).catch((()=>{})),m.F.clear()):m.F.fail("还没有选中的漫画")}},computed:{isEmpty(){return 0===this.collections.length},isSelectAll(){let e=!1;for(let t=0;t<this.selected.length;t++)if(!this.selected[t]){e=!1;break}return e},isSelectedNum(){let e=0;for(let t=0;t<this.selected.length;t++)this.selected[t]&&e++;return e}},created(){m.F.loading({message:"加载数据中...QAQ",duration:0}),this.init()}};const Di=(0,r.Z)(Pi,[["render",Wi],["__scopeId","data-v-e70c4eec"]]);var Li=Di;const Ti={style:{"overflow-x":"hidden"}},Hi={key:0,class:"grid"},Oi=["onClick"],zi=["onClick"],Mi={class:"grid-selected"},$i={class:"book-title"},Fi={class:"book-tag"},Vi={id:"foot-group",class:"van-hairline--top"};function Bi(e,t,i,n,s,l){const r=(0,a.up)("van-checkbox"),c=(0,a.up)("van-image"),d=(0,a.up)("van-empty");return(0,a.wg)(),(0,a.iD)("div",Ti,[l.isEmpty||s.loadingPage?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",Hi,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.collections,((e,t)=>(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",{class:"grid-item",onClick:e=>l.bookClick(t),key:t},[(0,a.Wm)(c,{radius:"10",height:"160",width:"120",src:e.book.image_url,style:{position:"relative"}},{default:(0,a.w5)((()=>[(0,a.wy)((0,a._)("div",{onClick:e=>s.selected[t]=!s.selected[t],class:"grid-cover"},null,8,zi),[[o.F8,i.isEdit]]),(0,a.wy)((0,a._)("div",Mi,[(0,a.Wm)(r,{modelValue:s.selected[t],"onUpdate:modelValue":e=>s.selected[t]=e},null,8,["modelValue","onUpdate:modelValue"])],512),[[o.F8,i.isEdit]])])),_:2},1032,["src"]),(0,a._)("div",$i,(0,L.zw)(e.book.name),1),(0,a.wy)((0,a._)("div",{class:"book-tag van-ellipsis"},(0,L.zw)("看到"+e.last_read_chapter),513),[[o.F8,1===e.is_read]]),(0,a.wy)((0,a._)("div",Fi,"未阅读过该小说",512),[[o.F8,0===e.is_read]])],8,Oi)),[[o.F8,1===e.collect]]))),128))])),(0,a.Wm)(o.uT,{name:"van-slide-up"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a._)("div",Vi,[(0,a._)("div",{onClick:t[0]||(t[0]=(...e)=>l.selectAll&&l.selectAll(...e))},(0,L.zw)(l.isSelectAll?"取消全选":"全选(已选"+l.isSelectedNum+"/"+s.selected.length+")"),1),(0,a._)("div",{onClick:t[1]||(t[1]=(...e)=>l.deleteCollections&&l.deleteCollections(...e)),style:{color:"red"}},"删除")],512),[[o.F8,i.isEdit]])])),_:1}),l.isEmpty?((0,a.wg)(),(0,a.j4)(d,{key:1,description:"这里什么都没有(っ °Д °;)っ"})):(0,a.kq)("",!0)])}var qi={name:"bookCollectionPage",props:["isEdit"],data(){return{loadingPage:!0,collections:[],selected:[]}},methods:{async init(){m.F.loading({message:"加载数据中...QAQ",duration:0}),this.loadingPage=!0,this.$emit("setEdit",!1),this.selected=[];const e=this.$user.id;await Ce({user_id:e}).then((e=>{this.collections=e.data;for(let t=0;t<this.collections.length;t++)this.selected.push(!1)})),this.loadingPage=!1,m.F.clear()},bookClick(e){this.isEdit||this.$router.push("/bookInfo/"+this.collections[e].book.id)},selectAll(){const e=this.isSelectAll;for(let t=0;t<this.collections.length;t++)this.selected[t]=!e},deleteCollections(){0!==this.isSelectedNum?(Ut.V.confirm({title:"提示",message:"确定要将这些小说从书架中移除吗？"}).then((()=>{const e=this.$user.id,t=[];for(let i in this.selected)this.selected[i]&&t.push(this.collections[i].id);console.log(t),Ie({user_id:e,delete_list:JSON.stringify(t)}).then((()=>this.init()))})).catch((()=>{})),m.F.clear()):m.F.fail("还没有选中的小说")}},computed:{isEmpty(){return 0===this.collections.length},isSelectAll(){let e=!1;for(let t=0;t<this.selected.length;t++)if(!this.selected[t]){e=!1;break}return e},isSelectedNum(){let e=0;for(let t=0;t<this.selected.length;t++)this.selected[t]&&e++;return e}},created(){this.init()}};const Ei=(0,r.Z)(qi,[["render",Bi],["__scopeId","data-v-45c393ec"]]);var Ni=Ei,Ui={name:"collectionPage",components:{BookCollectionPage:Ni,MangaCollectionPage:Li},data(){return{isEdit:!1,active:0}},methods:{setEdit(e){this.isEdit=e}}};const ji=(0,r.Z)(Ui,[["render",ki]]);var Yi=ji;const Ai=(0,a.Uk)(" 左划可以收藏，右滑可以删除记录哦！(｡･∀･)ﾉﾞ ");function Ji(e,t,i,o,n,s){const l=(0,a.up)("van-icon"),r=(0,a.up)("van-nav-bar"),c=(0,a.up)("van-sticky"),d=(0,a.up)("van-notice-bar"),h=(0,a.up)("manga-history-page"),u=(0,a.up)("van-tab"),m=(0,a.up)("book-history-page"),g=(0,a.up)("van-tabs");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r,{title:"历史记录","left-text":"返回","left-arrow":"",style:{height:"50px"}},{left:(0,a.w5)((()=>[(0,a.Wm)(l,{name:"arrow-left",size:"18",color:"black",onClick:t[0]||(t[0]=e=>this.$router.back())})])),_:1})])),_:1}),(0,a.Wm)(d,{color:"#1989fa",background:"#ecf9ff",style:{marginBottom:"10px"},mode:"closeable"},{"left-icon":(0,a.w5)((()=>[(0,a.Wm)(l,{name:"info-o",size:"16",style:{"margin-right":"10px"}})])),default:(0,a.w5)((()=>[Ai])),_:1}),(0,a.Wm)(g,{active:e.active,"onUpdate:active":t[1]||(t[1]=t=>e.active=t),type:"card",color:"#999999",onClickTab:t[2]||(t[2]=t=>e.isEdit=!1)},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{title:"漫画"},{default:(0,a.w5)((()=>[(0,a.Wm)(h)])),_:1}),(0,a.Wm)(u,{title:"小说"},{default:(0,a.w5)((()=>[(0,a.Wm)(m)])),_:1})])),_:1},8,["active"])],64)}const Ki=e=>((0,a.dD)("data-v-9953e256"),e=e(),(0,a.Cn)(),e),Zi={style:{"margin-top":"10px"}},Qi=["onClick"],Ri=["src"],Gi={class:"history-info"},Xi={class:"van-ellipsis"},eo=Ki((()=>(0,a._)("div",null,null,-1))),to=Ki((()=>(0,a._)("div",null,"上次阅读时间",-1)));function io(e,t,i,n,s,l){const r=(0,a.up)("van-button"),c=(0,a.up)("van-swipe-cell"),d=(0,a.up)("van-empty");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.wy)((0,a._)("div",Zi,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.historyList,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{key:t},[(0,a.Wm)(c,null,{left:(0,a.w5)((()=>[(0,a.Wm)(r,{square:"",type:"primary",onClick:e=>l.setCollect(t),text:e.collect?"取消收藏":"收藏漫画",class:"delete-button"},null,8,["onClick","text"])])),right:(0,a.w5)((()=>[(0,a.Wm)(r,{square:"",onClick:e=>l.deleteHistory(t),text:"删除",type:"danger",class:"delete-button"},null,8,["onClick"])])),default:(0,a.w5)((()=>[(0,a._)("div",{class:"history-item van-hairline--bottom",onClick:t=>this.$router.push("/mangaInfo/"+e.manga.id)},[(0,a._)("div",null,[(0,a._)("img",{class:"history-img",src:e.manga.image_url},null,8,Ri)]),(0,a._)("div",Gi,[(0,a._)("div",Xi,[(0,a._)("b",null,(0,L.zw)(e.manga.title),1)]),(0,a._)("div",null,(0,L.zw)(e.manga.author.name),1),eo,to,(0,a._)("div",null,(0,L.zw)(l.stampToTime(e.last_read_time)),1)])],8,Qi)])),_:2},1024)])))),128))],512),[[o.F8,!l.isEmpty&&!s.loadingPage]]),l.isEmpty?((0,a.wg)(),(0,a.j4)(d,{key:0,description:"这里什么都没有(っ °Д °;)っ"})):(0,a.kq)("",!0)],64)}var oo={name:"mangaHistoryPage",data(){return{loadingPage:!0,historyList:[]}},methods:{async init(){m.F.loading({message:"获取浏览历史中...",duration:0}),this.loadingPage=!0,await Z({user_id:this.$user.id}).then((e=>this.historyList=e.data)),this.loadingPage=!1,m.F.clear()},stampToTime(e){e=parseInt(1e3*e);const t=new Date(e),i=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes());return i},async setCollect(e){m.F.loading({message:"请求中",duration:0});const t=this.historyList[e].collect,i=this.historyList[e].manga.id;await J({user_id:this.$user.id,manga_id:i,collect:0===t?1:0}),await Z({user_id:this.$user.id}).then((e=>{this.historyList=e.data})),m.F.clear()},async deleteHistory(e){m.F.loading({message:"请求中",duration:0});const t=this.$user.id,i=this.historyList[e].manga.id;await Q({user_id:t,manga_id:i}).then((e=>{this.historyList=e.data})),m.F.clear()}},computed:{isEmpty(){return 0===this.historyList.length}},created(){this.init()}};const ao=(0,r.Z)(oo,[["render",io],["__scopeId","data-v-9953e256"]]);var no=ao;const so=e=>((0,a.dD)("data-v-4706f4bd"),e=e(),(0,a.Cn)(),e),lo={style:{"margin-top":"10px"}},ro=["onClick"],co=["src"],ho={class:"history-info"},uo={class:"van-ellipsis"},mo=so((()=>(0,a._)("div",null,null,-1))),go=so((()=>(0,a._)("div",null,"上次阅读时间",-1)));function po(e,t,i,n,s,l){const r=(0,a.up)("van-button"),c=(0,a.up)("van-swipe-cell"),d=(0,a.up)("van-empty");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.wy)((0,a._)("div",lo,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.historyList,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{key:t},[(0,a.Wm)(c,null,{left:(0,a.w5)((()=>[(0,a.Wm)(r,{square:"",type:"primary",onClick:e=>l.setCollect(t),text:e.collect?"取消收藏":"收藏漫画",class:"delete-button"},null,8,["onClick","text"])])),right:(0,a.w5)((()=>[(0,a.Wm)(r,{square:"",onClick:e=>l.deleteHistory(t),text:"删除",type:"danger",class:"delete-button"},null,8,["onClick"])])),default:(0,a.w5)((()=>[(0,a._)("div",{class:"history-item van-hairline--bottom",onClick:t=>this.$router.push("/bookInfo/"+e.book.id)},[(0,a._)("div",null,[(0,a._)("img",{class:"history-img",src:e.book.image_url},null,8,co)]),(0,a._)("div",ho,[(0,a._)("div",uo,[(0,a._)("b",null,(0,L.zw)(e.book.name),1)]),(0,a._)("div",null,(0,L.zw)(e.book.author.name),1),mo,go,(0,a._)("div",null,(0,L.zw)(l.stampToTime(e.last_read_time)),1)])],8,ro)])),_:2},1024)])))),128))],512),[[o.F8,!l.isEmpty&&!s.loadingPage]]),l.isEmpty?((0,a.wg)(),(0,a.j4)(d,{key:0,description:"这里什么都没有(っ °Д °;)っ"})):(0,a.kq)("",!0)],64)}var wo={name:"bookHistoryPage",data(){return{loadingPage:!0,historyList:[]}},methods:{async init(){m.F.loading({message:"获取浏览历史中...",duration:0}),this.loadingPage=!0,await be({user_id:this.$user.id}).then((e=>this.historyList=e.data)),this.loadingPage=!1,m.F.clear()},stampToTime(e){e=parseInt(1e3*e);const t=new Date(e),i=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes());return i},async setCollect(e){m.F.loading({message:"请求中",duration:0});const t=this.historyList[e].collect,i=this.historyList[e].book.id;await fe({user_id:this.$user.id,book_id:i,collect:0===t?1:0}),await be({user_id:this.$user.id}).then((e=>{this.historyList=e.data})),m.F.clear()},async deleteHistory(e){m.F.loading({message:"请求中",duration:0});const t=this.$user.id,i=this.historyList[e].book.id;await Se({user_id:t,book_id:i}).then((e=>{this.historyList=e.data})),m.F.clear()}},computed:{isEmpty(){return 0===this.historyList.length}},created(){this.init()}};const vo=(0,r.Z)(wo,[["render",po],["__scopeId","data-v-4706f4bd"]]);var ko=vo,fo={name:"historyPage",components:{BookHistoryPage:ko,MangaHistoryPage:no},data(){return{activePage:0}}};const _o=(0,r.Z)(fo,[["render",Ji]]);var yo=_o;const bo={style:{"background-image":"url('https://img0.baidu.com/it/u=3360627435,179419772&fm=253&fmt=auto&app=138&f=JPEG?w=200&h=200')"}},Co={id:"user-head-group"},Io=(0,a.Uk)("退出登录");function So(e,t,i,o,n,s){const l=(0,a.up)("van-icon"),r=(0,a.up)("van-nav-bar"),c=(0,a.up)("van-image"),d=(0,a.up)("van-cell"),h=(0,a.up)("van-cell-group"),u=(0,a.up)("van-button");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(r,{title:"个人主页","left-text":"返回","left-arrow":"",style:{height:"50px"}},{left:(0,a.w5)((()=>[(0,a.Wm)(l,{name:"arrow-left",size:"18",color:"black",onClick:t[0]||(t[0]=e=>this.$router.back())})])),_:1}),(0,a._)("div",bo,[(0,a._)("div",Co,[(0,a.Wm)(c,{height:"100",width:"100",round:"",src:"https://img0.baidu.com/it/u=3360627435,179419772&fm=253&fmt=auto&app=138&f=JPEG?w=200&h=200"})])]),(0,a.Wm)(h,{title:"个人信息"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{title:"用户id",value:n.user.id},null,8,["value"]),(0,a.Wm)(d,{title:"用户名",value:n.user.username},null,8,["value"]),(0,a.Wm)(d,{title:"昵称",value:n.user.nickname,"is-link":""},null,8,["value"]),(0,a.Wm)(d,{title:"手机号",value:"未绑定","is-link":""}),(0,a.Wm)(d,{title:"邮箱",value:n.user.email},null,8,["value"]),(0,a.Wm)(d,{title:"加入时间",value:n.user.create_time.split("T")[0]},null,8,["value"])])),_:1}),(0,a.Wm)(u,{type:"danger",size:"large",onClick:s.logout},{default:(0,a.w5)((()=>[Io])),_:1},8,["onClick"])])}var xo={name:"userPage",data(){return{user:{}}},methods:{logout(){Ut.V.confirm({title:"提示",message:"确定要退出登录吗？"}).then((()=>{localStorage.clear(),this.$router.push("/login/")})).catch((()=>{}))}},created(){this.user=this.$user}};const Wo=(0,r.Z)(xo,[["render",So],["__scopeId","data-v-2882f8df"]]);var Po=Wo;const Do=e=>((0,a.dD)("data-v-52b2b961"),e=e(),(0,a.Cn)(),e),Lo={key:0,style:{"overflow-x":"hidden"}},To={id:"info-group"},Ho={id:"info-img-group"},Oo={id:"info-text-group"},zo={key:0},Mo={key:1},$o={id:"info-button-group"},Fo=Do((()=>(0,a._)("span",null,"开始阅读",-1))),Vo=[Fo],Bo={class:"chapter-group"},qo={class:"chapter-list-title-group"},Eo=Do((()=>(0,a._)("b",null,"章节目录",-1))),No={class:"chapter-list"},Uo=["onClick"],jo={key:0},Yo={class:"van-ellipsis"},Ao={class:"van-ellipsis"},Jo=Do((()=>(0,a._)("div",null,"新!",-1)));function Ko(e,t,i,o,n,s){const l=(0,a.up)("van-share-sheet"),r=(0,a.up)("van-icon"),c=(0,a.up)("van-nav-bar"),d=(0,a.up)("van-image"),h=(0,a.up)("van-badge");return n.loadingPage?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",Lo,[(0,a.Wm)(l,{show:n.showShare,"onUpdate:show":t[0]||(t[0]=e=>n.showShare=e),title:"立即分享给好友",options:n.shareOptions},null,8,["show","options"]),(0,a.Wm)(c,{title:n.bookInfo.name,"left-text":"返回","left-arrow":""},{left:(0,a.w5)((()=>[(0,a.Wm)(r,{name:"arrow-left",size:"18",color:"black",onClick:t[1]||(t[1]=e=>this.$router.back())})])),right:(0,a.w5)((()=>[(0,a.Wm)(r,{onClick:t[2]||(t[2]=e=>n.showShare=!0),name:"share-o",size:"18",color:"black"})])),_:1},8,["title"]),(0,a._)("div",To,[(0,a._)("div",Ho,[(0,a.Wm)(d,{radius:"5",height:"150",width:"112.5",fit:"fill",src:n.bookInfo.image_url},null,8,["src"])]),(0,a._)("div",Oo,[(0,a._)("div",null,[(0,a.Wm)(r,{name:"user-o"}),(0,a._)("span",null,(0,L.zw)(n.bookInfo.author.name),1)]),(0,a._)("div",null,[(0,a.Wm)(r,{name:"description"}),(0,a._)("span",null,(0,L.zw)(s.stampToTime(n.bookInfo.update_time)),1)]),(0,a._)("div",null,[(0,a.Wm)(r,{name:"description"}),(0,a._)("span",null,(0,L.zw)(n.bookInfo.new_chapter_name),1)]),(0,a._)("div",null,[(0,a.Wm)(r,{name:"edit"}),(0,a._)("span",null,(0,L.zw)(n.bookInfo.status),1)]),(0,a._)("div",null,[(0,a.Wm)(r,{name:"clock-o"}),0===n.bookHistory.is_read?((0,a.wg)(),(0,a.iD)("span",zo,"还没有阅读过该小说")):(0,a.kq)("",!0),1===n.bookHistory.is_read?((0,a.wg)(),(0,a.iD)("span",Mo,"上次读到:"+(0,L.zw)(n.bookHistory.last_read_chapter),1)):(0,a.kq)("",!0)]),(0,a._)("div",$o,[(0,a._)("div",{id:"read-button",onClick:t[3]||(t[3]=(...e)=>s.startRead&&s.startRead(...e))},Vo),(0,a._)("div",{id:"collect-button",onClick:t[4]||(t[4]=(...e)=>s.setCollect&&s.setCollect(...e))},[(0,a._)("span",null,(0,L.zw)(s.collectStatus),1)])])])]),(0,a._)("div",{id:"detail-group",onClick:t[5]||(t[5]=e=>n.hiddenDetail=!n.hiddenDetail),class:(0,L.C_)(n.hiddenDetail?"detail-hidden":"")}," 简介:"+(0,L.zw)(n.bookInfo.detail),3),(0,a._)("div",Bo,[(0,a._)("div",qo,[(0,a._)("div",null,[(0,a.Wm)(r,{name:"bookmark-o"}),Eo]),(0,a._)("div",{onClick:t[6]||(t[6]=e=>s.orderList()),class:(0,L.C_)(0===n.orderType?"chapter-order":"")},[(0,a.Uk)(" 排序方式:"+(0,L.zw)(0===n.orderType?"倒序":"正序")+" ",1),(0,a.Wm)(r,{name:"exchange"})],2)]),(0,a._)("div",No,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.bookChapterList,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"chapter-item",key:t,onClick:e=>s.openChapter(t)},[s.isNewChapter(t)?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",jo,[(0,a._)("div",Yo,(0,L.zw)(e.name),1)])),s.isNewChapter(t)?((0,a.wg)(),(0,a.j4)(h,{key:1,offset:[-5,3]},{content:(0,a.w5)((()=>[Jo])),default:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a._)("div",Ao,(0,L.zw)(e.name),1)])])),_:2},1024)):(0,a.kq)("",!0)],8,Uo)))),128)),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.blankNum(),(e=>((0,a.wg)(),(0,a.iD)("div",{class:"blank-item",key:e})))),128))])])]))}var Zo={name:"bookInfoPage",data(){return{loadingPage:!0,bookInfo:{},bookChapterList:[],bookHistory:{},showShare:!1,shareOptions:[{name:"微信",icon:"wechat"},{name:"朋友圈",icon:"wechat-moments"},{name:"微博",icon:"weibo"},{name:"QQ",icon:"qq"},{name:"复制链接",icon:"link"},{name:"分享海报",icon:"poster"},{name:"二维码",icon:"qrcode"},{name:"小程序码",icon:"weapp-qrcode"}],hiddenDetail:!0,orderType:1}},methods:{async init(){m.F.loading({message:"加载信息中",duration:0}),this.loadingPage=!0;const e=this.$route.params.id;await we({book_id:e}).then((e=>{localStorage.setItem("currentBookInfo",JSON.stringify(e.data)),this.bookInfo=e.data})),await ve({book_url:this.bookInfo.book_url}).then((e=>{localStorage.setItem("currentBookChapterList",JSON.stringify(e.data)),this.bookChapterList=e.data}));const t=this.$user.id;await ke({user_id:t,book_id:this.bookInfo.id}).then((e=>{this.bookHistory=e.data})),this.loadingPage=!1,m.F.clear()},blankNum(){return 4-this.bookChapterList.length%4},isNewChapter(e,t){const i=this.bookChapterList,o=this.orderType,a=0===o?0:i.length-1;return t===a},orderList(){this.orderType=0===this.orderType?1:0,this.bookChapterList.reverse()},openChapter(e){0===this.orderType?this.$router.push("/bookView/"+(this.bookChapterList.length-e-1)):this.$router.push("/bookView/"+e)},startRead(){this.bookHistory&&Ut.V.confirm({title:"提示",message:"上次看到"+this.bookHistory.last_read_chapter+",是否继续阅读？"}).then((()=>{})).catch((()=>{}))},stampToTime(e){e=parseInt(1e3*e);const t=new Date(e),i=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes());return i},async setCollect(){const e=this.bookHistory.collect;Ut.V.confirm({title:"提示",message:0===e?"确认将该小说加入书架吗？":"确认将该小说从书架中移除吗？"}).then((()=>{fe({user_id:this.$user.id,book_id:this.bookInfo.id,collect:0===e?1:0}).then((e=>{localStorage.setItem("currentBookHistory",JSON.stringify(e.data)),this.bookHistory=e.data}))}))}},computed:{collectStatus(){return 0===this.bookHistory.collect?"加入书架":"移出书架"}},created(){this.init()},activated(){console.log(parseInt(this.$route.params.id),this.bookInfo.id),parseInt(this.$route.params.id)!==this.bookInfo.id?this.init():(window.scrollTo(0,0),console.log("缓存页面:漫画信息页"))}};const Qo=(0,r.Z)(Zo,[["render",Ko],["__scopeId","data-v-52b2b961"]]);var Ro=Qo;const Go=e=>((0,a.dD)("data-v-d78d48dc"),e=e(),(0,a.Cn)(),e),Xo={key:0,style:{width:"100%"}},ea={key:0,id:"view-head"},ta={id:"view-head-left"},ia={id:"view-head-content"},oa={id:"view-head-right"},aa=["innerHTML"],na={id:"view-foot-info-left",class:"van-ellipsis"},sa={id:"view-foot-info-right"},la={class:"van-ellipsis"},ra={key:0,id:"brightness-group"},ca={key:1,id:"settings-group"},da=Go((()=>(0,a._)("span",null,"字体大小",-1))),ha=Go((()=>(0,a._)("span",null,"字体颜色",-1))),ua={style:{display:"flex","justify-content":"space-between",width:"50%"}},ma=Go((()=>(0,a._)("span",null,"背景颜色",-1))),ga={style:{display:"flex","justify-content":"space-between",width:"50%"}},pa={key:0,id:"view-foot"},wa={class:"slider-group"},va={id:"view-foot-button-group"},ka=["onClick"],fa={style:{"margin-top":"5px"}},_a={id:"chapter-group"},ya={class:"van-hairline--bottom"},ba=["id"],Ca=(0,a.Uk)("当前章节"),Ia=(0,a.Uk)("阅读该话 ");function Sa(e,t,i,n,s,l){const r=(0,a.up)("van-share-sheet"),c=(0,a.up)("van-icon"),d=(0,a.up)("van-slider"),h=(0,a.up)("van-stepper"),u=(0,a.up)("van-tag"),m=(0,a.up)("van-button"),g=(0,a.up)("van-action-sheet");return s.loadingPage?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",Xo,[(0,a.Wm)(r,{show:s.showShare,"onUpdate:show":t[0]||(t[0]=e=>s.showShare=e),title:"立即分享给好友",options:s.shareOptions},null,8,["show","options"]),(0,a.Wm)(o.uT,{name:"van-slide-down"},{default:(0,a.w5)((()=>[s.showMenu?((0,a.wg)(),(0,a.iD)("div",ea,[(0,a._)("div",ta,[(0,a.Wm)(c,{name:"arrow-left",size:"18",onClick:t[1]||(t[1]=e=>this.$router.back())})]),(0,a._)("div",ia,(0,L.zw)(s.chapters[s.chapterIndex].name),1),(0,a._)("div",oa,[(0,a.Wm)(c,{onClick:t[2]||(t[2]=e=>s.showShare=!0),name:"share-o",size:"18"})])])):(0,a.kq)("",!0)])),_:1}),(0,a._)("div",{id:"view-content",style:(0,L.j5)(l.styleObject),onClick:t[3]||(t[3]=e=>l.openMenu()),innerHTML:s.content},null,12,aa),s.loadingPage?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",{key:0,id:"view-foot-info",style:(0,L.j5)({bottom:s.showMenu?"135px":0})},[(0,a._)("div",na,[(0,a._)("div",null,(0,L.zw)(s.browserNameVersion),1),(0,a._)("div",null,(0,L.zw)(s.time),1)]),(0,a._)("div",sa,[(0,a._)("div",la,(0,L.zw)(s.chapter.name),1)])],4)),(0,a.Wm)(o.uT,{name:"van-fade"},{default:(0,a.w5)((()=>[(0,a._)("div",null,[s.showBrightness?((0,a.wg)(),(0,a.iD)("div",ra,[(0,a.Wm)(c,{name:"closed-eye"}),(0,a.Wm)(d,{modelValue:s.settings.brightness,"onUpdate:modelValue":t[4]||(t[4]=e=>s.settings.brightness=e),"bar-height":"5px"},null,8,["modelValue"]),(0,a.Wm)(c,{name:"eye-o"})])):(0,a.kq)("",!0),s.showSettings?((0,a.wg)(),(0,a.iD)("div",ca,[(0,a._)("div",null,[da,(0,a.Wm)(h,{modelValue:s.settings.fontSize,"onUpdate:modelValue":t[5]||(t[5]=e=>s.settings.fontSize=e)},null,8,["modelValue"])]),(0,a._)("div",null,[ha,(0,a._)("div",ua,[(0,a._)("div",{onClick:t[6]||(t[6]=e=>s.settings.fontColor="black"),style:{width:"20px",height:"20px","background-color":"black"}}),(0,a._)("div",{onClick:t[7]||(t[7]=e=>s.settings.fontColor="white"),style:{width:"20px",height:"20px","background-color":"white"}}),(0,a._)("div",{onClick:t[8]||(t[8]=e=>s.settings.fontColor="red"),style:{width:"20px",height:"20px","background-color":"red"}})])]),(0,a._)("div",null,[ma,(0,a._)("div",ga,[(0,a._)("div",{onClick:t[9]||(t[9]=e=>s.settings.backgroundColor="black"),style:{width:"20px",height:"20px","background-color":"black"}}),(0,a._)("div",{onClick:t[10]||(t[10]=e=>s.settings.backgroundColor="white"),style:{width:"20px",height:"20px","background-color":"white"}}),(0,a._)("div",{onClick:t[11]||(t[11]=e=>s.settings.backgroundColor="rgb(212, 209, 209)"),style:{width:"20px",height:"20px","background-color":"rgb(212, 209, 209)"}})])])])):(0,a.kq)("",!0)])])),_:1}),(0,a.Wm)(o.uT,{name:"van-slide-up"},{default:(0,a.w5)((()=>[s.showMenu?((0,a.wg)(),(0,a.iD)("div",pa,[(0,a._)("div",wa,[(0,a._)("div",{onClick:t[12]||(t[12]=e=>l.openChapter(s.chapterIndex-1))},"上一话"),(0,a._)("div",{onClick:t[13]||(t[13]=e=>l.openChapter(s.chapterIndex+1))},"下一话")]),(0,a._)("div",va,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.footButtons,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"view-foot-button-item",key:t,onClick:e=>l.btnClick(t),style:(0,L.j5)({color:e.color})},[(0,a.Wm)(o.uT,{name:"van-fade"},{default:(0,a.w5)((()=>[e.loading?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(c,{key:0,size:"25",color:e.icon_color,name:e.icon,badge:e.badge},null,8,["color","name","badge"]))])),_:2},1024),(0,a.Wm)(o.uT,{name:"van-fade"},{default:(0,a.w5)((()=>[(0,a._)("div",fa,(0,L.zw)(e.text),1)])),_:2},1024)],12,ka)))),128))])])):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(g,{show:s.showChapterList,"onUpdate:show":t[15]||(t[15]=e=>s.showChapterList=e),style:{"background-color":"black",color:"white",height:"70%"}},{default:(0,a.w5)((()=>[(0,a._)("div",_a,[(0,a._)("div",ya,[(0,a._)("div",null,"全部章节("+(0,L.zw)(s.chapters.length)+")",1),(0,a._)("div",{style:(0,L.j5)({color:s.chapterListOrder?"#1989fa":"white"}),onClick:t[14]||(t[14]=e=>s.chapterListOrder=!s.chapterListOrder)},[(0,a._)("div",null,(0,L.zw)(s.chapterListOrder?"倒序":"正序"),1),(0,a.Wm)(c,{name:"exchange"})],4)]),(0,a._)("div",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.chapters,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{key:t,id:"chapter_"+t,class:"van-hairline--bottom chapter-item"},[(0,a._)("span",null,[(0,a.Uk)((0,L.zw)(e.name)+" ",1),t===s.chapterIndex?((0,a.wg)(),(0,a.j4)(u,{key:0,plain:"",type:"primary",style:(0,L.j5)({"background-color":"rgba(0,0,0,0"})},{default:(0,a.w5)((()=>[Ca])),_:1},8,["style"])):(0,a.kq)("",!0)]),(0,a.Wm)(m,{plain:"",color:"white",size:"small",style:(0,L.j5)({"background-color":"rgba(0,0,0,0)"}),icon:"arrow","icon-position":"right",onClick:e=>l.openChapter(t)},{default:(0,a.w5)((()=>[Ia])),_:2},1032,["style","onClick"])],8,ba)))),128))])])])),_:1},8,["show"])]))}var xa={name:"bookViewPage",data(){return{loadingPage:!0,showMenu:!1,showSettings:!1,bookHistory:{},chapters:[],chapter:{},content:"",images:[],imageIndex:0,chapterIndex:0,footButtons:[],settings:{brightness:100,backgroundColor:"#d4d1d1",fontColor:"#000000",fontSize:"15"},showBrightness:!1,showChapterList:!1,chapterListOrder:!1,time:"",browserNameVersion:mi(),showShare:!1,shareOptions:[{name:"微信",icon:"wechat"},{name:"朋友圈",icon:"wechat-moments"},{name:"微博",icon:"weibo"},{name:"QQ",icon:"qq"},{name:"复制链接",icon:"link"},{name:"分享海报",icon:"poster"},{name:"二维码",icon:"qrcode"},{name:"小程序码",icon:"weapp-qrcode"}]}},methods:{openMenu(){this.showBrightness=!1,this.showSettings=!1,this.showMenu=!this.showMenu},btnClick(e){this[this.footButtons[e]["clickable"]](e)},setCollect(e){const t=0===this.bookHistory.collect,i=JSON.parse(localStorage.getItem("currentBookInfo"));this.footButtons[e]["loading"]=!0,fe({user_id:this.$user.id,book_id:i.id,collect:t?1:0}).then((i=>{localStorage.setItem("currentBookHistory",JSON.stringify(i.data)),this.bookHistory=i.data,this.footButtons[e]["text"]=t?"已收藏":"收藏",this.footButtons[e]["icon"]=t?"star":"star-o",this.footButtons[e]["icon_color"]=t?"yellow":"",delete this.footButtons[e]["loading"],console.log("setCollect")}))},setBrightness(e){this.showMenu=!1,this.showSettings=!1,this.showBrightness=!0,console.log("setBrightness",e)},openSettingsMenu(e){this.showMenu=!1,this.showSettings=!0,this.showBrightness=!1,console.log("openSettingsMenu",e)},openChapterList(e){this.showMenu=!1,this.showChapterList=!0;var t=setInterval((()=>{const e=document.querySelector("#chapter_"+this.chapterIndex);null!==e&&(e.scrollIntoView(),clearInterval(t))}),500);console.log("openChapterList",e)},openChapter(e){this.chapterListOrder&&(this.chapterListOrder=!1,e=this.chapters.length-e-1),console.log(e),e<0?m.F.fail("已经是第一章了"):e>this.chapters.length-1?m.F.fail("没有更多章节了"):(console.log(e),this.$router.replace("/bookView/"+e))},getTime(){const e=new Date;this.time=e.getMonth()+"-"+e.getDay()+" "+e.getHours()+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())},setThemeColor(e){this.settings.backgroundColor=e;let t=document.getElementsByTagName("meta");for(let o=0;o<t.length;o++)if("theme-color"===t[o].name){t[o].remove();break}const i=document.createElement("meta");i.content=e,i.name="theme-color",document.getElementsByTagName("head")[0].appendChild(i)},async init(){m.F.loading({message:"加载图片中",duration:0}),this.loadingPage=!0,this.showMenu=!1,this.showChapterList=!1,this.showSettings=!1,this.chapterListOrder=!1,this.imageIndex=0,this.getTime(),setInterval(this.getTime,1e3),this.chapters=JSON.parse(localStorage.getItem("currentBookChapterList")),this.chapterIndex=parseInt(this.$route.params.chapterIndex),this.chapter=this.chapters[this.chapterIndex],await _e({chapter_url:this.chapter.url}).then((e=>{this.content=e.data})),await ye({user_id:this.$user.id,book_id:JSON.parse(localStorage.getItem("currentBookInfo")).id,last_read_chapter:this.chapter.name,last_read_url:this.chapter.url}).then((e=>{localStorage.setItem("currentBookHistory",JSON.stringify(e.data)),this.bookHistory=e.data}));const e=this.bookHistory.collect;this.footButtons=[{text:e?"已收藏":"收藏",icon:e?"star":"star-o",icon_color:e?"yellow":"",active:!1,clickable:"setCollect"},{text:"亮度",icon:"eye-o",active:!1,clickable:"setBrightness"},{text:"设置",icon:"setting-o",active:!1,clickable:"openSettingsMenu"},{text:"章节",icon:"orders-o",active:!1,clickable:"openChapterList"}],this.loadingPage=!1,m.F.clear(),this.setThemeColor(this.settings.backgroundColor)}},computed:{styleObject(){const e=this.settings;return{filter:"brightness("+e.brightness+"%)",backgroundColor:e.backgroundColor,fontSize:e.fontSize+"px",color:e.fontColor}}},watch:{$route(){console.log(this.$route.fullPath.substring(0,10)),"/bookView/"===this.$route.fullPath.substring(0,10)&&this.init()},chapterListOrder(){console.log("setOrder"),this.chapters.reverse(),this.chapterIndex=this.chapters.length-this.chapterIndex-1;const e=document.querySelector("#chapter_0");e.scrollIntoView()},showChapterList(){this.showChapterList||(this.chapterListOrder=!1)}},created(){this.init()},beforeUnmount(){this.setThemeColor("white")}};const Wa=(0,r.Z)(xa,[["render",Sa],["__scopeId","data-v-d78d48dc"]]);var Pa=Wa;const Da=[{path:"/",redirect:"/login"},{path:"/home",component:Te,meta:{keepAlive:!0}},{path:"/user",component:Po},{path:"/login",component:Ae},{path:"/register",component:Xe},{path:"/search",component:Ct},{path:"/mangaHome",name:"mangaIHomePage",component:ie},{path:"/mangaInfo/:id",name:"mangaInfoPage",component:At,meta:{keepAlive:!0}},{path:"/mangaView/:listIndex/:chapterIndex",component:wi},{path:"/collection",component:Yi},{path:"/history",component:yo},{path:"/mangaHistory",component:no},{path:"/bookHistory",component:ko},{path:"/bookInfo/:id",name:"bookInfoPage",component:Ro,meta:{keepAlive:!0}},{path:"/bookView/:chapterIndex",component:Pa}],La=(0,g.p7)({history:(0,g.r5)(),routes:Da});var Ta=La;const Ha=(0,o.ri)(d);Ha.use(u.J),Ha.use(h.ZP),Ha.use(m.F),Ha.use(Ta),Ha.use(h.ZP),Ha.config.globalProperties.$CODE=Ue,Ha.config.globalProperties.$Toast=m.F,Ha.config.globalProperties.$user=JSON.parse(localStorage.getItem("user")),Ha.mount("#app")}},t={};function i(o){var a=t[o];if(void 0!==a)return a.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,i),n.exports}i.m=e,function(){var e=[];i.O=function(t,o,a,n){if(!o){var s=1/0;for(d=0;d<e.length;d++){o=e[d][0],a=e[d][1],n=e[d][2];for(var l=!0,r=0;r<o.length;r++)(!1&n||s>=n)&&Object.keys(i.O).every((function(e){return i.O[e](o[r])}))?o.splice(r--,1):(l=!1,n<s&&(s=n));if(l){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[o,a,n]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};i.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,n,s=o[0],l=o[1],r=o[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(a in l)i.o(l,a)&&(i.m[a]=l[a]);if(r)var d=r(i)}for(t&&t(o);c<s.length;c++)n=s[c],i.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return i.O(d)},o=self["webpackChunkfront"]=self["webpackChunkfront"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=i.O(void 0,[998],(function(){return i(3243)}));o=i.O(o)})();
//# sourceMappingURL=app.cba4431a.js.map